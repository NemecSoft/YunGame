# 太集盒 (TGBox) 游戏管理器项目计划书

## 1. 产品概述

产品名称：太集盒 (TGBox)
- 名称含义：融合太极图、汇集与Game盒（游戏盒）的概念
- "集"寓意汇集，与Game的G发音相近，也体现大集合的含义

本项目是一款基于Avalonia框架开发的独立游戏管理器应用，参考Playnite但具备独特的设计理念和技术实现。核心目标是为玩家提供一个高性能、美观且易于使用的游戏库管理工具，特别专注于处理大规模游戏库时的性能优化。

## 2. 产品定位

- **目标用户**：PC游戏玩家
- **核心价值**：高性能游戏库管理、美观的用户界面、个性化定制
- **竞争优势**：基于Avalonia的跨平台支持、创新的高性能虚拟面板技术、轻量化设计

## 3. 核心设计

项目数据默认存储在`C:\Users\Administrator\AppData\Local\TGBox`，可调整为相对目录。

#### 3.1.1 用户与游戏级别管理

广告功能
- 广告位置：游戏列表、游戏详情页
- 广告类型：banner广告、视频广告
- 广告展示频率：根据用户行为和游戏类型动态调整

**用户级别**：
- 0级：管理员
- 1级：普通用户（黄金用户）
- 2级：普通用户（钻石用户）

**游戏级别**：
- 1级游戏
- 2级游戏

**权限规则**：
- 1级黄金用户只能游玩1级游戏
- 2级钻石用户可以游玩1级和2级游戏
- 总结：用户只能玩小于等于自己级别的游戏

**管理规则**：
- 游戏级别由管理员设定
- 用户级别由管理员设定

**用户级别判断逻辑**：
1. 企业外网IP地址
2. 个人登录账号
3. 其他逻辑，例如配置文件中硬指定

#### 3.1.2 游玩模式

- **功能定位**：专注于游戏体验和快速启动
- **权限限制**：
  - 禁止添加、修改、删除游戏
  - 禁止编辑游戏信息、海报、截图
  - 禁止管理游戏存档和MOD
- **允许操作**：
  - 启动和运行游戏
  - 查看游戏基本信息和状态
  - 使用已配置的游戏启动参数
  - 查看游戏统计数据

#### 3.1.3 管理模式

- **功能定位**：完整的游戏库管理和维护
- **完整权限**：
  - 游戏扫描和导入（自动/手动）
  - 游戏信息编辑（名称、类型、年份、描述）
  - 多媒体管理：
    - 添加/编辑游戏海报（支持多张轮播）
    - 添加/管理游戏截图（最多6张）
    - 添加/管理游戏视频攻略
  - 游戏存档管理：
    - 自动备份游戏存档
    - 存档版本管理
    - 存档云同步（可选）
  - MOD管理：
    - MOD安装/卸载
    - MOD版本控制
    - MOD冲突检测
  - 游戏删除（支持软删除到回收站）

### 3.2 高性能虚拟面板

- **功能描述**：实现能够高效处理1000+游戏项目的列表视图，确保滚动流畅、响应迅速
- **技术实现**：
  - 采用虚拟列表（VirtualizingList）技术，仅渲染视口内可见项
  - 实现数据虚拟化，按需加载游戏信息
  - 使用异步数据绑定和UI更新
  - 优化项容器复用机制
- **性能指标**：
  - 支持10000+游戏项目无卡顿滚动
  - 首次加载时间<2秒
  - 内存占用比同类产品降低30%

### 3.3 游戏库管理

- **智能扫描**：支持自动扫描和导入本地游戏
- **平台集成**：支持Steam、Epic Games、GOG、Ubisoft Connect等主流游戏平台
- **分类系统**：多级分类和标签系统，支持自定义标签
- **状态跟踪**：游戏安装状态、最后游玩时间、总游玩时长统计
- **批量操作**：支持批量编辑、移动、删除游戏

### 3.4 用户界面

- **模式切换**：一键切换游玩/管理模式，界面元素动态调整
- **主题系统**：现代化设计，支持明暗主题，支持自定义主题
- **视图模式**：网格视图、列表视图、详情视图、封面流模式
- **响应式设计**：支持4K和高DPI显示，自适应窗口大小
- **动画效果**：流畅的过渡动画和交互动画

### 3.5 其他特性

- **启动参数**：游戏启动参数自定义和预设管理
- **备份恢复**：游戏备份和恢复功能，支持增量备份
- **插件系统**：完整的插件API和扩展机制
- **跨平台**：支持Windows、Linux、macOS三大平台
- **性能监控**：实时监控系统资源使用情况

## 4. 技术架构

### 4.1 前端架构

- 基于Avalonia 11.x框架
- MVVM设计模式
- ReactiveUI用于响应式编程
- 使用Avalonia.VirtualizingPanel自定义高性能面板

### 4.2 后端架构

- .NET 8.0运行时
- 本地数据存储：SQLite
- 游戏平台集成：REST API + 本地进程通信
- 异步编程模型：Task-based Async Pattern

### 4.3 核心技术组件

- **高性能虚拟面板**：自定义的VirtualizingPanel实现
- **游戏元数据引擎**：负责游戏信息的获取和处理
- **平台集成服务**：与各游戏平台的接口
- **数据持久化层**：优化的数据库访问层

## 5. 开发计划

### 5.1 阶段一：核心框架与模式架构（3周）

- 搭建Avalonia项目框架
- 实现MVVM架构和ReactiveUI集成
- 设计并实现双模式架构（游玩模式/管理模式）
- 开发模式切换机制和权限控制系统
- 实现基础数据模型和游戏实体类
- 实现游戏展示方式：
  1. **卡片列表显示模式（Card-List Mode）**：每个游戏占用一个卡片，显示游戏名称、6张图片、启动按钮、状态指示器
  2. **网格Grid显示模式**：紧凑的网格布局，支持缩略图预览
  3. **详情视图模式**：单游戏详细信息展示

### 5.2 阶段二：管理模式功能开发（4周）

- **游戏扫描和导入系统**：
  - 自动扫描本地游戏目录
  - 支持Steam、Epic Games、GOG等平台游戏导入
  - 手动添加游戏功能
- **多媒体管理系统**：
  - 游戏海报管理（支持多张海报轮播）
  - 游戏截图管理（最多6张）
  - 视频攻略上传和管理
- **游戏信息编辑**：
  - 完整的游戏元数据编辑界面
  - 批量编辑功能
  - 游戏分类和标签系统
- **存档管理系统**：
  - 自动存档备份机制
  - 存档版本管理
  - 存档恢复功能

### 5.3 阶段三：游玩模式优化与高级功能（5周）

- **游玩模式优化**：
  - 只读界面设计
  - 快速启动优化
  - 游戏状态监控
- **MOD管理系统**：
  - MOD安装/卸载界面
  - MOD冲突检测
  - MOD版本管理
- **平台集成完善**：
  - 多平台账户连接
  - 游戏库同步
  - 成就系统集成
- **高级功能**：
  - 游戏统计和分析
  - 性能监控面板
  - 自定义主题系统

### 5.4 阶段四：测试、优化与文档（2周）

- **模式切换测试**：权限控制验证、界面状态切换测试
- **性能测试**：大规模游戏库性能测试、内存占用优化
- **用户体验测试**：双模式用户流程测试、界面响应性测试
- **跨平台兼容性测试**：Windows/Linux/macOS三平台测试
- **文档完善**：
  - 用户操作手册（游玩模式/管理模式分别说明）
  - 开发者文档（模式架构说明）
  - API文档更新

## 6. 技术挑战与解决方案

### 6.1 双模式系统架构

- **挑战**：确保两种模式间的状态同步和权限控制
- **解决方案**：
  - 设计模式状态管理器，统一处理模式切换
  - 实现基于角色的UI权限控制系统
  - 使用MVVM模式分离视图逻辑，确保模式切换时数据不丢失
  - 实现模式切换动画和过渡效果

### 6.2 高性能虚拟面板

- **挑战**：在保持UI响应性的同时处理大量数据项
- **解决方案**：
  - 实现视口外项目的延迟加载
  - 使用对象池技术复用UI元素
  - 采用增量更新和后台加载策略
  - 优化数据绑定路径

### 6.3 跨平台兼容性

- **挑战**：确保在不同操作系统上的一致体验
- **解决方案**：
  - 使用Avalonia的跨平台API
  - 针对特定平台的优化和适配
  - 自动化测试覆盖主要平台

### 6.4 游戏平台集成

- **挑战**：各平台API差异和认证机制
- **解决方案**：
  - 设计统一的平台接口抽象层
  - 采用适配器模式处理平台差异
  - 实现安全的凭证存储机制

### 6.5 多媒体数据管理

- **挑战**：高效管理大量游戏多媒体文件（海报、截图、视频）
- **解决方案**：
  - 实现智能缓存机制，按需加载多媒体内容
  - 使用缩略图技术减少内存占用
  - 实现异步文件I/O操作，避免UI阻塞
  - 支持多媒体文件的增量更新和同步

## 7. 预期目标

- 首个版本支持管理10000+游戏项目
- 滚动帧率保持在60FPS以上
- 内存占用控制在同类产品的70%
- 支持Windows、Linux和macOS三大平台
- 提供完整的插件开发文档
- 建立活跃的用户社区

## 8. 后续规划

- 移动配套应用
- 云同步功能
- 多人游戏库共享
- AI推荐系统
- 游戏性能优化建议